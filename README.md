# SDLS - Summary of Changes in Light Scattering Simulation (DLS package)
[The text below comes from Appendix to Jethva et al., "Ground-based MFRSR UV-Vis spectral retrievals of Saharan dust absorption at Izaña Observatory", Egusphere 2025, 4890, doi: https://doi.org/10.5194/egusphere-2025-4890]

Here, we summarize the simplifications implemented in the streamlined, swift DLS package (SDLS). DLS (Dubovik et al., 2006: https://doi.org/10.1029/2005JD006619) is FORTRAN code that calculates radiative parameters (extinction and absorption coefficients, and the phase matrix) for light scattering by a group of randomly oriented spheroids, based on their optical (real n and imaginary k parts of the refractive index) and geometric (size r and aspect ratio ε distributions, D(r) and D(ε), respectively) parameters, and the particle concentration.

To expedite calculations, DLS utilizes two types of look-up tables (LUTs), also called kernels. First are “main” kernels K of size ~5 GB defined on specific grids of all the mentioned parameters. The fixed kernels k are pre-computed from the respective main K-s at a given aspect ratio distribution D(ε). The LUT approach accelerates the calculation of the radiative parameters from the fixed kernels k using, as input, a user-defined (bimodal) size distribution function, particle concentration, and wavelength λ. DLS defines the kernels K and k for a fixed λ = 0.340 μm because the mentioned radiative parameters depend on the size parameter x = 2πr/λ.

However, the implementation of the kernel-based approach in the original DLS package was found to be computationally inefficient and time consuming given the 1-minute intervals of a multi-year MFRSR observational record (see the abovemention paper by Jethva et al.). Both K and k are stored in ASCII (text) format, with arrays of different sizes and shape located in the same file. For instance, the phase matrix as a function of scattering angle is provided for subsequent calculations while the r-grid is stored just for reference. Iterative reading of this data format is time-consuming, and the corresponding reader is not laconic.

Next, DLS relies on a computationally expensive cubic spline for interpolating the fixed kernels k from the given r-grid to the user-defined grid r0. However, the spline functionality is used inefficiently; its coefficients are calculated inside the loop over r0, despite they do not depend on it. This has been noted by other users before us. Furthermore, DLS calls the spline over r for two points of the n-grid interval that contains the user’s value n0 (same for k – 4 calls total). Then, bilinear interpolation is used to get the output at the user’s n0 and k0. By switching the sequence of the interpolations – first bilinear over the refractive index, then spline over the size – the number of spline calls is reduced from 4 to 1. Even that single spline call can be eliminated since we integrate over the size, making interpolation between size grids unnecessary. Note that instead of the lognormal size distribution D(ln(r)), it is more natural to use the size parameter distribution D(ln(x)) for integration over particle size.

To overcome the noted inefficiencies, we have implemented the following changes to the DLS package for deriving an equivalent but much faster and efficient SDLS software tool.

1. The original FORTRAN code was translated to C/C++, as this work was initiated as part of translation of MAIAC’s (Lyapustin et al., 2021) polarized radiative transfer solver IPOL (Korkin and Lyapustin, 2023) from FORTRAN into C.
